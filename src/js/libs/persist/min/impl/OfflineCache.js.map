{"version":3,"sources":["../../../src/impl/OfflineCache.js"],"names":["define","cacheHandler","OfflineCache","name","persistencestore","TypeError","this","_name","_store","_applyVaryForSingleMatch","ignoreVary","request","cacheEntries","length","index","cacheEntry","_applyVaryCheck","responseData","_applyVaryForAllMatches","responseDataArray","filter","_filterByVary","map","entry","propertyName","cacheValue","propertyValue","cacheRequestHeaders","requestData","headers","cacheResponseHeaders","requestHeaders","varyValue","vary","trim","varyArray","split","varyHeaderName","toLowerCase","requestVaryHeaderValue","get","cachedRequestVaryHeaderValue","_cacheEntryToResponse","promises","bodyAbstract","push","Promise","resolve","JSON","parse","constructResponse","all","_cacheEntriesToResponses","promisesArray","element","_buildBodyAbstract","shreddedPayload","keys","resourceType","stringify","prototype","getName","add","self","fetch","then","response","responseClone","clone","put","addAll","requests","match","options","searchCriteria","constructSearchCriteria","find","results","fillResponseBodyWithShreddedData","matchAll","responseArray","responseElement","constructRequestResponseCacheData","shredResponse","requestResponsePair","storePromises","value","upsert","key","metadata","cacheShreddedData","delete","reject","keysArray","removeByKey","result","catch","error","fields","dataArray","filteredEntries","err","hasMatch","matchEntry"],"mappings":"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","file":"OfflineCache.js"}