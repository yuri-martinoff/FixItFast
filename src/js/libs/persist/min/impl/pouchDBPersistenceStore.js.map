{"version":3,"sources":["../../../src/impl/pouchDBPersistenceStore.js"],"names":["define","PersistenceStore","PouchDB","PouchDBPersistenceStore","name","call","this","prototype","Init","options","_version","version","dbname","_name","_db","index","self","indexArray","indexName","toString","replace","indexSyntax","fields","Promise","resolve","reject","createIndex","then","catch","err","upsert","key","metadata","value","expectedVersionIdentifier","docId","attachmentParts","_prepareUpsert","get","doc","_verifyVersionIdentifier","status","geterr","message","existingDoc","_put","dbdoc","_id","_rev","put","addeddoc","puterr","conflictDoc","finalDoc","_addAttachments","currentDocument","versionIdentifier","length","promises","map","attachment","blob","Blob","putAttachment","id","path","rev","all","upsertAll","values","element","find","findExpression","modifiedFind","_prepareFind","result","docs","_findResultCallback","finderr","entries","useDefaultField","_fixValue","fixedDoc","attachments","_attachments","filename","Object","keys","getAttachment","paths","split","targetValue","pathIndex","findByKey","removeByKey","remove","delete","deleteExpression","modifiedExpression","promisesArray","allDocs","include_docs","rows","keysArray","undefined","sort","selector","$gt","modifiedFields","x","_inspectValue","hasOwnProperty","itemValue","ArrayBuffer","localPath","push","oldPath"],"mappings":"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","file":"pouchDBPersistenceStore.js"}