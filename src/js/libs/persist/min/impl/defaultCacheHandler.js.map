{"version":3,"sources":["../../../src/impl/defaultCacheHandler.js"],"names":["define","persistenceUtils","persistenceStoreManager","DefaultCacheHandler","Object","defineProperty","this","value","writable","_updateShreddedDataStore","shreddedData","promises","map","element","storeName","keys","storeData","length","_updateShreddedDataForStore","Promise","resolve","all","openStore","then","store","upsertAll","_convertShreddedData","entry","name","resourceIdentifierValue","resourceIdentifier","ids","shreddedDataArray","currentTime","Date","toUTCString","i","data","key","metadata","lastUpdated","push","convertedEntry","_fillStoreValue","storeEntry","findByKey","transformedKeys","keyValue","findExpression","selector","$or","find","results","Array","isArray","fill","prototype","constructRequestResponseCacheData","request","response","self","reject","dataField","requestToJSON","requestJSONData","requestData","excludeBody","_excludeBody","responseToJSON","responseJSONData","responseData","_constructCacheKey","constructMetadata","catch","err","constructShreddedData","shredder","_getShredder","shreddedObjArray","shredResponse","cacheShreddedData","url","method","headers","varyValue","get","getTime","requestHeaders","varyFields","split","index","varyField","created","lastupdated","constructResponse","responseFromJSON","isCachedResponse","set","constructSearchCriteria","options","ignoreSearch","undefined","ignoreMethod","selectorField","searchURL","searchStartIndex","indexOf","substring","metadata.url","$regex","escapeRegExp","sort","metadata.created","registerEndpointOptions","endpointKey","Error","message","_endpointToOptionsMap","unregisterEndpointOptions","jsonProcessor","_getJsonProcessor","_getUnshredder","unshredder","allKeys","JSON","parse","option","fillResponseBodyWithShreddedData","bodyAbstract","str","String","replace"],"mappings":"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","file":"defaultCacheHandler.js"}